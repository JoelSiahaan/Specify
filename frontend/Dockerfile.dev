# frontend/Dockerfile.dev
# Development Dockerfile with Vite dev server

FROM node:20.19.0-alpine

# Set working directory
WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies with cache mount (OPTIMIZED for faster rebuilds)
RUN --mount=type=cache,target=/root/.npm,sharing=locked \
    npm install --prefer-offline && \
    npm cache clean --force

# Copy source code
COPY . .

# Expose Vite dev server port
EXPOSE 5173

# Health check (using nc instead of wget for Alpine)
HEALTHCHECK --interval=30s --timeout=3s --start-period=30s --retries=3 \
  CMD nc -z localhost 5173 || exit 1

# Start Vite dev server with host 0.0.0.0 to allow external access
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0"]
